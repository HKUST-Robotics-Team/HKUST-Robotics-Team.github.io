const F=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerpolicy&&(i.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?i.credentials="include":n.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}};F();function u(e){e=Math.round(e),e<0&&(e=0);const t=("0"+Math.floor(e%1e3/10)).slice(-2),s=("0"+Math.floor(e/1e3%60)).slice(-2);return`${("0"+Math.floor(e/60/1e3)).slice(-2)}:${s}.${t}`}var P="/RDC2022/assets/countdown.d79f80a0.mp3",$="/RDC2022/assets/long_beeps.c5591596.mp3",B="/RDC2022/assets/beeps.3e6219b9.mp3";class V{constructor(){this.isRunning=!1,this.startTime=0,this.overallTime=0}_getTimeElapsedSinceLastStart(){return this.startTime?Date.now()-this.startTime:0}start(){this.isRunning||(this.isRunning=!0,this.startTime=Date.now())}stop(){!this.isRunning||(this.isRunning=!1,this.overallTime=this.overallTime+this._getTimeElapsedSinceLastStart())}reset(){if(this.overallTime=0,this.isRunning){this.startTime=Date.now();return}this.startTime=0}getTime(){return this.startTime?this.isRunning?this.overallTime+this._getTimeElapsedSinceLastStart():this.overallTime:0}}const d=document.querySelector("#countdown-timer"),l=document.querySelector("#countup-timer"),R=document.querySelector("#stop");let _=0,m=0,E=!1;const b=new V,S=new Audio;S.src=P;S.preload="auto";S.volume=.5;const g=new Audio;g.src=$;g.preload="auto";g.volume=.5;const x=new Audio;x.src=B;x.preload="auto";x.volume=.5;const A=30*1e3,L=1*60*1e3,h=3*60*1e3;function C(e=L){d.disabled=!1,l.disabled=!1,m=e,b.start(),_=setInterval(j,8)}function v(){d.disabled=!0,l.disabled=!0,b.stop(),clearInterval(_)}function j(){const e=b.getTime();if(e>=m-5200&&!E&&(E=!0,S.play()),m===h&&e>=h){g.play(),v(),R.click(),l.innerText=u(h),d.innerText=u(0),l.classList.add("times-up"),d.classList.add("times-up");const t=new CustomEvent("timerEnded",{detail:{targetTime:h}});document.dispatchEvent(t);return}else m==L&&e>=L?(E=!1,x.play(),v(),b.reset(),C(h)):m===A&&e>=A&&(g.play(),v(),R.click(),l.innerText=u(A),d.innerText=u(0),l.classList.add("times-up"),d.classList.add("times-up"));l.innerText=u(e),d.innerText=u(m-e)}function D(){_=0,b.reset(),E=!1,m=L,d.innerText=u(L),l.innerText=u(0),l.classList.remove("times-up"),d.classList.remove("times-up")}const f={},N=[{en:"Alpha",chi:"\u4E00\u5254\u904E"},{en:"Too easy",chi:"\u592A\u96E3"},{en:"Triumphus",chi:"\u51F1\u6607"},{en:"Stonks",chi:"\u91CD\u5728\u53C3\u8207\u7D44"},{en:"Fibotics",chi:"\u5F975\u5F97"},{en:"Sixy Guys",chi:"\u788C\u67DA"},{en:"24/7"},{en:"Fleming",chi:"\u5F17\u83B1\u660E"}],G=["123","456","789","147","258","369","159","357"],T=document.querySelector("#start"),y=document.querySelector("#stop"),w=document.querySelector("#reset"),k=document.querySelector("#appeal");document.querySelector("#save");document.querySelector("#load");document.querySelector("#cal-final-score");const U=document.querySelectorAll(".team-name"),M=document.querySelectorAll(".counter"),O={red:document.querySelector("#red-base"),blue:document.querySelector("#blue-base")},c=document.querySelector("#grid");let p;U.forEach(e=>{N.forEach(({en:t,chi:s})=>{const o=document.createElement("option");o.value=t,o.text=t,e.appendChild(o)}),e.addEventListener("change",t=>{var n;const s=e.parentElement.querySelector("label"),o=N.find(i=>i.en===t.target.value);o&&(s.innerText=(n=o.chi)!=null?n:"")})});M.forEach(e=>{f[e.id]=0,e.addEventListener("contextmenu",t=>t.preventDefault()),e.addEventListener("mousedown",t=>{H(t,e.id),e.innerText=f[e.id],e.id.split("-").slice(0,1)})});Object.values(O).forEach(e=>{e.addEventListener("click",t=>{t.currentTarget.textContent="\u2713"}),e.addEventListener("contextmenu",t=>{t.preventDefault(),t.currentTarget.textContent=""})});const z=(e,t)=>{const s=document.createElement("div"),o=document.createElement("span"),n=document.createElement("span");return s.className="grid-select-menu absolute z-10 flex gap-1 bottom-[90%] left-1/2 -translate-x-1/2 transform bg-gray-400 p-1",o.className="block p-1 bg-red-500 cursor-pointer hover:bg-red-700",n.className="block p-1 bg-blue-500 cursor-pointer hover:bg-blue-700",o.innerText="Red",n.innerText="Blue",o.addEventListener("click",i=>{i.stopPropagation(),e.classList.remove("bg-[#545454]","bg-blue-700"),e.classList.add("bg-red-700"),e.dataset.color="red",t()}),n.addEventListener("click",i=>{i.stopPropagation(),e.classList.remove("bg-[#545454]","bg-red-700"),e.classList.add("bg-blue-700"),e.dataset.color="blue",t()}),s.appendChild(o),s.appendChild(n),s};Array.from(c.children).forEach(e=>{const t=()=>{const s=new CustomEvent("cellClicked");document.dispatchEvent(s),document.querySelectorAll(".grid-select-menu").forEach(o=>o.remove())};e.addEventListener("click",s=>{if(s.stopImmediatePropagation(),e.querySelector(".grid-select-menu"))return;document.querySelectorAll(".grid-select-menu").forEach(n=>n.remove());const o=z(e,t);e.appendChild(o)}),e.addEventListener("contextmenu",s=>{s.preventDefault(),s.target.classList.remove("bg-red-700","bg-blue-700"),s.target.classList.add("bg-[#545454]"),delete s.target.dataset.color,t()})});document.addEventListener("mousedown",e=>{c.contains(e.target)||document.querySelectorAll(".grid-select-menu").forEach(t=>t.remove())});document.addEventListener("cellClicked",e=>{const t=Array.from(c.children).filter(r=>r.dataset.color),s=t.filter(r=>r.dataset.color==="red"),o=t.filter(r=>r.dataset.color==="blue"),n=s.map(r=>r.id),i=o.map(r=>r.id);G.forEach(r=>{const a=c.querySelector(`[data-comb='${r}']`);if(n.includes(r[0])&&n.includes(r[1])&&n.includes(r[2])){a||I(r,"red");const q=new CustomEvent("greatVictory",{detail:{team:"red"}});document.dispatchEvent(q)}else(a==null?void 0:a.dataset.color)==="red"&&c.removeChild(a);if(i.includes(r[0])&&i.includes(r[1])&&i.includes(r[2])){a||I(r,"blue");const q=new CustomEvent("greatVictory",{detail:{team:"blue"}});document.dispatchEvent(q)}else(a==null?void 0:a.dataset.color)==="blue"&&c.removeChild(a)})});function I(e,t){const s=document.createElement("div");switch(s.className="bg-[#FFDF00BC] pointer-events-none rounded-full h-[5%] absolute transform -translate-x-1/2 -translate-y-1/2",s.dataset.comb=e,s.dataset.color=t,e){case"123":s.classList.add("w-[80%]","top-1/6","left-1/2");break;case"456":s.classList.add("w-[80%]","top-1/2","left-1/2");break;case"789":s.classList.add("w-[80%]","top-5/6","left-1/2");break;case"147":s.classList.add("w-[80%]","top-1/2","left-1/6","rotate-90");break;case"258":s.classList.add("w-[80%]","top-1/2","left-1/2","rotate-90");break;case"369":s.classList.add("w-[80%]","top-1/2","left-5/6","rotate-90");break;case"159":s.classList.add("w-full","top-1/2","left-1/2","rotate-45");break;case"357":s.classList.add("w-full","top-1/2","left-1/2","-rotate-45");break}c.appendChild(s)}function H(e,t){if(typeof e=="object")switch(e.button){case 0:return f[t]++,"+1";case 2:return f[t]--,"-1"}}T.addEventListener("click",()=>{T.disabled=!0,y.classList.remove("hidden"),w.classList.add("hidden"),C()});y.addEventListener("click",()=>{y.classList.add("hidden"),w.classList.remove("hidden"),v()});w.addEventListener("click",()=>{T.disabled=!1,k.classList.add("hidden"),D(),W()});k.addEventListener("click",()=>{D(),T.disabled=!0,y.classList.remove("hidden"),w.classList.add("hidden"),C(30*1e3)});document.addEventListener("timerEnded",e=>{k.classList.remove("hidden")});function W(){M.forEach(e=>{f[e.id]=0,e.innerText=f[e.id]}),Object.values(O).forEach(e=>{e.textContent=""}),Array.from(c.children).forEach(e=>{e.classList.remove("bg-red-700","bg-blue-700"),e.classList.add("bg-[#545454]"),delete e.dataset.color}),c.querySelectorAll("div").forEach(e=>c.removeChild(e)),p==null||p.remove(),p=void 0}document.addEventListener("greatVictory",e=>{if(p)return;v(),y.click(),k.classList.remove("hidden");const t=document.createElement("div");t.classList.add("great-victory");const s=document.createElement("h1");s.innerText="Great Victory",s.classList.add("text-size-3xl","font-bold"),t.appendChild(s),document.querySelector(`#${e.detail.team}-team`).appendChild(t),p=t});
