var C=Object.defineProperty;var H=(e,t,r)=>t in e?C(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var j=(e,t,r)=>(H(e,typeof t!="symbol"?t+"":t,r),r);const D=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}};D();function l(e){const t=("0"+Math.floor(e%1e3/10)).slice(-2),r=("0"+Math.floor(e/1e3%60)).slice(-2);return`${("0"+Math.floor(e/60/1e3)).slice(-2)}:${r}.${t}`}function $(e){const t=-e.getTimezoneOffset(),r=t>=0?"+":"-",n=function(i){const s=Math.floor(Math.abs(i));return(s<10?"0":"")+s};return e.getFullYear()+"-"+n(e.getMonth()+1)+"-"+n(e.getDate())+"T"+n(e.getHours())+":"+n(e.getMinutes())+":"+n(e.getSeconds())+r+n(t/60)+":"+n(t%60)}function F(e,t="result.json"){var r=document.createElement("a");r.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(JSON.stringify(e))),r.setAttribute("download",t),r.click()}function G(e,t,r){const n={createdAt:$(new Date),data:{red:{name:e.red,finalScore:t.red.final,greatVictory:t.red.greatVictory,win:t.red.win,records:r.red},blue:{name:e.blue,finalScore:t.blue.final,greatVictory:t.blue.greatVictory,win:t.blue.win,records:r.blue}}};F(n,"result.json")}const U=new CustomEvent("greatVictory",{detail:{team:"red"}}),z=new CustomEvent("greatVictory",{detail:{team:"blue"}}),O=class{constructor(t,r,n,i="+1"){this.time=l(t),this.team=r.split("-").slice(0,1),this.action=O.object_list[r]+" "+i,this.score=n.score,this.multi=n.multi}toHTML(){const t=document.createElement("div");return t.className="record flex py-2",t.innerHTML=`<span>${this.time}</span><span>${this.action}</span><span>${this.score} (x${this.multi})</span>`,t}toObj(){return{time:this.time,action:this.action,score:this.score,multi:this.multi}}};let L=O;j(L,"object_list",{"red-plate":"plate","red-pot-1":"pot 1","red-pot-2":"pot 2","red-smartcar":"smartcar","blue-plate":"plate","blue-pot-1":"pot 1","blue-pot-2":"pot 2","blue-smartcar":"smartcar"});function P(e){let t={red_pot:0,red_plate:0,red_smartcar:0,blue_pot:0,blue_plate:0,blue_smartcar:0};return Object.entries(e).forEach(([r,n])=>{const[i,s,...a]=r.split("-");if(i=="red")switch(s){case"pot":t.red_pot+=n;break;case"plate":t.red_plate+=n;break;case"smartcar":t.red_smartcar=n;break}else if(i=="blue")switch(s){case"pot":t.blue_pot+=n;break;case"plate":t.blue_plate+=n;break;case"smartcar":t.blue_smartcar=n;break}}),t}function B(e,t,r){const n=e%2*50+Math.floor(e/2)*200+t%2*75+Math.floor(t/2)*300,i=1+r*.01;return{score:n,mul:i}}function E(e,t=!1){const{red_pot:r,red_plate:n,red_smartcar:i,blue_pot:s,blue_plate:a,blue_smartcar:N}=P(e);let{score:m,mul:T}=B(r,n,i),{score:f,mul:y}=B(s,a,N);const _=r>=2&&n>=2,w=s>=2&&a>=2;return _&&document.dispatchEvent(U),w&&document.dispatchEvent(z),t?(m*=T,f*=y,{red:{score:m,multi:T,gv:_,win:m>f||_},blue:{score:f,multi:y,gv:w,win:f>m||w}}):{red:{score:m,multi:T},blue:{score:f,multi:y}}}class J{constructor(){this.isRunning=!1,this.startTime=0,this.overallTime=0}_getTimeElapsedSinceLastStart(){return this.startTime?Date.now()-this.startTime:0}start(){this.isRunning||(this.isRunning=!0,this.startTime=Date.now())}stop(){!this.isRunning||(this.isRunning=!1,this.overallTime=this.overallTime+this._getTimeElapsedSinceLastStart())}reset(){if(this.overallTime=0,this.isRunning){this.startTime=Date.now();return}this.startTime=0}getTime(){return this.startTime?this.isRunning?this.overallTime+this._getTimeElapsedSinceLastStart():this.overallTime:0}}var K="/assets/countdown.d79f80a0.mp3",Y="/assets/long_beeps.c5591596.mp3";const I=document.querySelectorAll(".counter"),o={},v={red:[],blue:[]},Q=["Alkaline Metal","Now","Delta Three-ta","4gotton","Team Fire","Cancer","Group 7","Infinity","Cloud9"],S=document.querySelector("#start"),p=document.querySelector("#stop"),x=document.querySelector("#reset"),W=document.querySelector("#save"),X=document.querySelector("#load"),Z=document.querySelector("#cal-final-score"),u=document.querySelector("#countdown-timer"),d=document.querySelector("#countup-timer"),M=document.querySelectorAll(".team-name"),c={red:document.querySelector("#red-scoreboard"),blue:document.querySelector("#blue-scoreboard"),redBig:document.querySelector("#red-score"),blueBig:document.querySelector("#blue-score")},k=new Audio;k.src=K;k.preload="auto";const q=new Audio;q.src=Y;q.preload="auto";const b=3*60*1e3;let A=0;const h=new J;let g=null,R=!1;M.forEach(e=>{Q.forEach(t=>{const r=document.createElement("option");r.value=t,r.text=t,e.appendChild(r)})});I.forEach(e=>{o[e.id]=0,e.addEventListener("mousedown",t=>{const r=ee(t,e.id);e.innerText=o[e.id];const n=E(o),i=e.id.split("-").slice(0,1),s=new L(h.getTime(),e.id,n[i],r);c[i].prepend(s.toHTML()),c[i+"Big"].innerText=n[i].score,v[i].push(s.toObj())})});function ee(e,t){if(typeof e=="object")switch(e.button){case 0:return o[t]++,"+1";case 2:return o[t]--,"-1"}}function te(){A=0,h.reset(),R=!1,u.innerText=l(b),d.innerText=l(0),d.classList.remove("times-up"),u.classList.remove("times-up"),v.red=[],v.blue=[],I.forEach(e=>{o[e.id]=0,e.innerText=o[e.id]}),c.red.innerHTML="",c.blue.innerHTML="",c.redBig.innerText="0",c.blueBig.innerText="0",g&&(g.outerHTML="",g=null)}function V(){h.stop(),clearInterval(A),p.click()}function re(){const e=h.getTime();if(e>=b-5200&&!R&&(R=!0,k.play()),e>=b){V(),d.innerText=l(b),u.innerText=l(0),d.classList.add("times-up"),u.classList.add("times-up"),q.play();return}d.innerText=l(e),u.innerText=l(b-e)}S.addEventListener("click",()=>{S.disabled=!0,p.classList.remove("hidden"),x.classList.add("hidden"),u.disabled=!1,d.disabled=!1,h.start(),A=setInterval(re,8)});p.addEventListener("click",()=>{u.disabled=!0,d.disabled=!0,p.classList.add("hidden"),x.classList.remove("hidden"),V()});x.addEventListener("click",()=>{S.disabled=!1,te()});W.addEventListener("click",()=>{const e=E(o,!0);G({red:M[1].value,blue:M[0].value},{red:{final:e.red.score,greatVictory:e.red.gv,win:e.red.win},blue:{final:e.blue.score,greatVictory:e.blue.gv,win:e.blue.win}},v)});Z.addEventListener("click",()=>{const e=E(o,!0);c.blueBig.innerText=+e.blue.score.toFixed(1),c.redBig.innerText=+e.red.score.toFixed(1)});X.addEventListener("click",()=>{});document.addEventListener("greatVictory",e=>{if(!g){V(),p.click();const t=document.createElement("div");t.classList.add("great-victory");const r=document.createElement("h1");r.innerText="Great Victory",r.classList.add("text-size-3xl","font-bold"),t.appendChild(r);const n=c[e.detail.team+"Big"];n.parentNode.insertBefore(t,n.nextSibling),g=t}});
